<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Obstacle Race</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- START -->
    <div id="screen-start" class="screen active">
        <a href="/" class="back-link">‚Üê –ù–∞–∑–∞–¥</a>
        <div class="logo">
            <div class="logo-runner">
                <svg viewBox="0 0 40 58" xmlns="http://www.w3.org/2000/svg" style="width:50px;height:68px;display:block;overflow:visible">
                    <circle cx="20" cy="6" r="5" fill="none" stroke-width="2.5" stroke-linecap="round"/>
                    <line x1="20" y1="14" x2="20" y2="36" stroke-width="2.5" stroke-linecap="round"/>
                    <g>
                        <animateTransform attributeName="transform" type="rotate" values="-30,20,14;40,20,14;-30,20,14" dur="0.8s" repeatCount="indefinite" calcMode="spline" keySplines="0.45 0 0.55 1;0.45 0 0.55 1"/>
                        <polyline points="20,14 20,23 28,23" fill="none" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </g>
                    <g>
                        <animateTransform attributeName="transform" type="rotate" values="40,20,14;-30,20,14;40,20,14" dur="0.8s" repeatCount="indefinite" calcMode="spline" keySplines="0.45 0 0.55 1;0.45 0 0.55 1"/>
                        <polyline points="20,14 20,23 28,23" fill="none" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </g>
                    <g>
                        <animateTransform attributeName="transform" type="rotate" values="20,20,36;-45,20,36;20,20,36" dur="0.8s" repeatCount="indefinite" calcMode="spline" keySplines="0.45 0 0.55 1;0.45 0 0.55 1"/>
                        <polyline points="20,36 20,47 10,47" fill="none" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </g>
                    <g>
                        <animateTransform attributeName="transform" type="rotate" values="-45,20,36;20,20,36;-45,20,36" dur="0.8s" repeatCount="indefinite" calcMode="spline" keySplines="0.45 0 0.55 1;0.45 0 0.55 1"/>
                        <polyline points="20,36 20,47 10,47" fill="none" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </g>
                </svg>
            </div>
            <h1>OBSTACLE<br>RACE</h1>
            <p class="subtitle">–ü—Ä–µ–æ–¥–æ–ª–µ–π –±–∞—Ä—å–µ—Ä—ã. –û–±–º–∞–Ω–∏ —Å–æ–ø–µ—Ä–Ω–∏–∫–∞.</p>
        </div>
        <div class="form">
            <input type="text" id="player-name" placeholder="–¢–≤–æ—ë –∏–º—è" maxlength="15" autocomplete="off">
            <button class="btn primary" id="btn-find">–ù–∞–π—Ç–∏ —Å–æ–ø–µ—Ä–Ω–∏–∫–∞</button>
            <button class="btn secondary" id="btn-bot">–ò–≥—Ä–∞—Ç—å —Å –±–æ—Ç–æ–º</button>
        </div>
        <div class="rules-hint">
            <details>
                <summary>–ö–∞–∫ –∏–≥—Ä–∞—Ç—å?</summary>
                <div class="rules-text">
                    <p><b>1.</b> –†–∞—Å—Å—Ç–∞–≤—å 3 –±–∞—Ä—å–µ—Ä–∞ –Ω–∞ –¥–æ—Ä–æ–∂–∫–µ —Å–æ–ø–µ—Ä–Ω–∏–∫–∞</p>
                    <p><b>2.</b> –ö–∞–∂–¥—ã–π —Ä–∞—É–Ω–¥ –≤—ã–±–∏—Ä–∞–π: –±–µ–∂–∞—Ç—å –∏–ª–∏ –ø—Ä—ã–≥–Ω—É—Ç—å</p>
                    <p><b>3.</b> –ë–µ–∂–∞—Ç—å + –Ω–µ—Ç –±–∞—Ä—å–µ—Ä–∞ = +1 –æ—á–∫–æ</p>
                    <p><b>4.</b> –ü—Ä—ã–≥–Ω—É—Ç—å + –µ—Å—Ç—å –±–∞—Ä—å–µ—Ä = +1 –æ—á–∫–æ</p>
                    <p><b>5.</b> –ü–µ—Ä–≤—ã–π –¥–æ 5 –æ—á–∫–æ–≤ ‚Äî –ø–æ–±–µ–¥–∏—Ç–µ–ª—å</p>
                    <p style="margin-top:10px"><b>üåü –°–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏</b> ‚Äî –≤ –Ω–∞—á–∞–ª–µ –∏–≥—Ä—ã –æ–±–∞ –∏–≥—Ä–æ–∫–∞ –ø–æ–ª—É—á–∞—é—Ç –ø–æ –æ–¥–Ω–æ–π —Å–ª—É—á–∞–π–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏. –°–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Å–æ–ø–µ—Ä–Ω–∏–∫–∞ —Å–∫—Ä—ã—Ç–∞, –ø–æ–∫–∞ –æ–Ω –µ—ë –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç. –ò—Å–ø–æ–ª—å–∑—É–π 1 —Ä–∞–∑ –∑–∞ –∏–≥—Ä—É ‚Äî –Ω–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –¥–æ –≤—ã–±–æ—Ä–∞ —Ö–æ–¥–∞:</p>
                    <p><b>üëÅ –†–µ–Ω—Ç–≥–µ–Ω</b> ‚Äî –≤—ã–±–µ—Ä–∏ —Ç–æ—á–∫—É –Ω–∞ —Å–≤–æ–µ–π –¥–æ—Ä–æ–∂–∫–µ –∏ —É–∑–Ω–∞–π, –µ—Å—Ç—å –ª–∏ —Ç–∞–º –±–∞—Ä—å–µ—Ä —Å–æ–ø–µ—Ä–Ω–∏–∫–∞. –ü–æ–ª–µ–∑–Ω–æ –ø–µ—Ä–µ–¥ –ø—Ä–∏–Ω—è—Ç–∏–µ–º —Ä–µ—à–µ–Ω–∏—è.</p>
                    <p><b>‚ö° –£–¥–≤–æ–µ–Ω–∏–µ</b> ‚Äî —Å—Ç–∞–≤–∏—à—å –≤—Å—ë –Ω–∞ –∫–æ–Ω. –£—Å–ø–µ—à–Ω—ã–π —Ö–æ–¥ = +2 –æ—á–∫–∞. –ü–æ–ø–∞–ª –Ω–∞ –±–∞—Ä—å–µ—Ä = ‚àí1 –æ—á–∫–æ –≤–º–µ—Å—Ç–æ 0.</p>
                    <p><b>üíÄ –°–∞–±–æ—Ç–∞–∂</b> ‚Äî –æ—Ç–º–µ–Ω—è–µ—Ç –æ—á–∫–æ —Å–æ–ø–µ—Ä–Ω–∏–∫–∞ –≤ —ç—Ç–æ–º —Ä–∞—É–Ω–¥–µ (–≤–∫–ª—é—á–∞—è —É–¥–≤–æ–µ–Ω–Ω—ã–µ). –ï—Å–ª–∏ –æ–Ω –∏ —Ç–∞–∫ –ø–æ–ø–∞–ª –Ω–∞ –±–∞—Ä—å–µ—Ä ‚Äî –ø—Ä–æ–º–∞—Ö, –Ω–æ –±–µ–∑ —à—Ç—Ä–∞—Ñ–∞.</p>
                    <p style="margin-top:10px"><b>‚è± –û–≤–µ—Ä—Ç–∞–π–º</b> ‚Äî –ø—Ä–∏ –Ω–∏—á—å–µ–π –ø–æ—Å–ª–µ 7 —Ä–∞—É–Ω–¥–æ–≤ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –æ–≤–µ—Ä—Ç–∞–π–º: 5 –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–∞—É–Ω–¥–æ–≤. –ö–∞–∂–¥—ã–π —Ä–∞—Å—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ 2 –±–∞—Ä—å–µ—Ä–∞. –°–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –≤ –æ–≤–µ—Ä—Ç–∞–π–º–µ –Ω–µ –¥–µ–π—Å—Ç–≤—É—é—Ç.</p>
                </div>
            </details>
        </div>
    </div>

    <!-- WAITING -->
    <div id="screen-waiting" class="screen">
        <div class="center-content">
            <div class="spinner"></div>
            <h2>–ò—â–µ–º —Å–æ–ø–µ—Ä–Ω–∏–∫–∞...</h2>
            <button class="btn secondary" id="btn-cancel">–û—Ç–º–µ–Ω–∞</button>
        </div>
    </div>

    <!-- TRAPS -->
    <div id="screen-traps" class="screen">
        <div class="traps-content">
            <h2>–†–∞—Å—Å—Ç–∞–≤—å –ª–æ–≤—É—à–∫–∏!</h2>
            <p class="traps-sub">–ù–∞–∂–º–∏ –Ω–∞ —Ç–æ—á–∫–∏ –¥–æ—Ä–æ–∂–∫–∏ —Å–æ–ø–µ—Ä–Ω–∏–∫–∞</p>
            <div class="opponent-badge" id="opp-name-traps"></div>
            <div class="trap-track" id="trap-track"></div>
            <div class="trap-counter">
                –õ–æ–≤—É—à–µ–∫: <span id="trap-count" class="count-num">0</span> / 3
            </div>
            <button class="btn primary" id="btn-traps-ok" disabled>–ì–æ—Ç–æ–≤–æ!</button>
            <div class="wait-msg hidden" id="traps-wait">
                <div class="spinner sm"></div>
                <span>–°–æ–ø–µ—Ä–Ω–∏–∫ —Ä–∞—Å—Å—Ç–∞–≤–ª—è–µ—Ç...</span>
            </div>
        </div>
    </div>

    <!-- GAME -->
    <div id="screen-game" class="screen">
        <div class="game-wrap">
            <div class="scoreboard">
                <div class="sb-player you">
                    <div class="sb-avatar you-color"></div>
                    <span class="sb-name" id="sb-name-0">–¢—ã</span>
                    <span class="sb-score" id="sb-score-0">0</span>
                </div>
                <div class="sb-center">
                    <span class="round-num" id="round-num">–†–∞—É–Ω–¥</span>
                    <span class="round-val" id="round-val">1/7</span>
                </div>
                <div class="sb-player opp">
                    <div class="sb-avatar opp-color"></div>
                    <span class="sb-name" id="sb-name-1">–°–æ–ø–µ—Ä–Ω–∏–∫</span>
                    <span class="sb-score" id="sb-score-1">0</span>
                </div>
            </div>

            <div class="tracks-area">
                <div class="game-track" id="gtrack-0">
                    <div class="track-header">
                        <span class="track-name" id="tname-0">–¢—ã</span>
                    </div>
                    <div class="track-line">
                        <div class="track-points" id="tpoints-0"></div>
                        <div class="track-avatar you-color" id="tavatar-0"></div>
                    </div>
                </div>
                <div class="game-track" id="gtrack-1">
                    <div class="track-header">
                        <span class="track-name" id="tname-1">–°–æ–ø–µ—Ä–Ω–∏–∫</span>
                    </div>
                    <div class="track-line">
                        <div class="track-points" id="tpoints-1"></div>
                        <div class="track-avatar opp-color" id="tavatar-1"></div>
                    </div>
                </div>
            </div>

            <div id="action-zone">
                <div id="ability-zone" class="hidden">
                    <button class="btn ability-btn" id="btn-ability"></button>
                    <div class="ability-opp-line">–°–æ–ø–µ—Ä–Ω–∏–∫: <span id="opp-ability-status"></span></div>
                </div>
                <div id="action-prompt">
                    <p id="prompt-text">–ß—Ç–æ –¥–µ–ª–∞–µ—à—å –Ω–∞ —ç—Ç–æ–π —Ç–æ—á–∫–µ?</p>
                    <div class="timer-bar"><div class="timer-fill" id="timer-fill"></div></div>
                </div>
                <div class="action-btns" id="action-btns">
                    <button class="btn action run-btn" id="btn-run">
                        <span class="action-icon">&#9654;</span>
                        –ë–ï–ñ–ê–¢–¨
                    </button>
                    <button class="btn action jump-btn" id="btn-jump">
                        <span class="action-icon">&#9650;</span>
                        –ü–†–´–ì–ù–£–¢–¨
                    </button>
                </div>

                <div class="wait-msg hidden" id="move-wait">
                    <div class="spinner sm"></div>
                    <span>–°–æ–ø–µ—Ä–Ω–∏–∫ –¥—É–º–∞–µ—Ç...</span>
                </div>
            </div>

            <!-- Ability reveal overlay -->
            <div class="ability-reveal-overlay hidden" id="ability-reveal">
                <div class="arev-card">
                    <div class="arev-title">–¢–≤–æ—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å</div>
                    <div class="arev-icon" id="arev-icon"></div>
                    <div class="arev-name" id="arev-name"></div>
                    <div class="arev-desc" id="arev-desc"></div>
                    <div class="arev-opp-line">–°–æ–ø–µ—Ä–Ω–∏–∫—É: <span id="arev-opp"></span></div>
                    <div class="arev-hint">–ò—Å–ø–æ–ª—å–∑—É–π 1 —Ä–∞–∑ –∑–∞ –∏–≥—Ä—É. –ù–∞–∂–º–∏ —á—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å</div>
                </div>
            </div>

            <!-- Overtime announcement -->
            <div class="overtime-overlay hidden" id="overtime-announce">
                <h1 class="ot-title">–û–í–ï–†–¢–ê–ô–ú!</h1>
                <p class="ot-sub">–ü–µ—Ä–≤—ã–π –∫—Ç–æ –≤—ã—Ä–≤–µ—Ç—Å—è –≤–ø–µ—Ä—ë–¥ ‚Äî –ø–æ–±–µ–¥–∏—Ç</p>
            </div>

            <div class="round-reveal hidden" id="round-reveal">
                <div class="reveal-row">
                    <div class="reveal-card" id="reveal-you">
                        <div class="reveal-label">–¢—ã</div>
                        <div class="reveal-action" id="reveal-you-action"></div>
                        <div class="reveal-result" id="reveal-you-result"></div>
                    </div>
                    <div class="reveal-vs">VS</div>
                    <div class="reveal-card" id="reveal-opp">
                        <div class="reveal-label">–°–æ–ø–µ—Ä–Ω–∏–∫</div>
                        <div class="reveal-action" id="reveal-opp-action"></div>
                        <div class="reveal-result" id="reveal-opp-result"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- RESULT -->
    <div id="screen-result" class="screen">
        <div class="center-content">
            <div class="result-emoji" id="result-emoji"></div>
            <h1 id="result-title"></h1>
            <p id="result-sub" class="result-sub"></p>
            <div class="final-scores">
                <div class="fs-item">
                    <span class="fs-name" id="fs-name-0"></span>
                    <span class="fs-val" id="fs-val-0"></span>
                </div>
                <span class="fs-dash">&mdash;</span>
                <div class="fs-item">
                    <span class="fs-name" id="fs-name-1"></span>
                    <span class="fs-val" id="fs-val-1"></span>
                </div>
            </div>
            <button class="btn primary" id="btn-again">–ò–≥—Ä–∞—Ç—å –µ—â—ë</button>
            <button class="btn secondary" id="btn-menu">–ö –∏–≥—Ä–∞–º</button>
        </div>
    </div>

    <script src="game.js"></script>
</body>
</html>
